<div>
    <mat-card class="gray-card-body">
        <mat-card-content>
            <h4>Eksportavimas</h4>
            <div class="row">
                <div class="col-12 employee-selection-list" *ngIf="employeeList">
                    <mat-form-field>
                        <mat-select (valueChange)="employeeSelectionChange()" placeholder="Pasirinkite darbuotojus"
                                    [formControl]="employeeSelectorControl" multiple>
                            <mat-option *ngFor="let employee of employeeList" [value]="employee.id">
                                {{employee.doc.firstname}} {{employee.doc.lastname}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
            </div>
            <mat-divider></mat-divider>
            <div class="row" *ngIf="calendarData">
                <div class="col-12">
                    <button mat-raised-button (click)="pdf.saveAs('Eksportas.pdf')">Eksportuoti PDF</button>
                    <button mat-raised-button (click)="closeAndExportXLS()">Eksportuoti XLS</button>
                    <mat-checkbox [(ngModel)]="displaySalary">Rodyti uždarbį</mat-checkbox>
                </div>
                <kendo-pdf-export #pdf>
                    <div class="col-12 doc-body" #docBody id="doc-body">
                        <div *ngFor="let year of calendarData.years">
                            <div *ngIf="year && year.months">
                                <div *ngFor="let month of year.months">
                                    <div *ngIf="month && month.employees">
                                        <!--<h5 class="text-center">{{getMonth(month.number)}}/{{year.year}}</h5>-->
                                        <h5 class="text-center">{{month['employees'][0].work_days[0].date |
                                            lithuanizeMonth:"month-year"}}</h5>
                                        <table>
                                            <thead>
                                            <tr class="schedule-tab-header">
                                                <td><strong>Darbuotojas(a)</strong></td>
                                                <td><strong>Pareigos</strong></td>
                                                <td *ngFor="let dayNumber of calendarDayNumbers"
                                                    class="day-cell-header">
                                                    <strong>{{dayNumber}}</strong></td>
                                                <td>Paprastu</td>
                                                <td>Naktiniu</td>
                                                <td>Sventiniu</td>
                                                <td>Is viso</td>
                                                <td *ngIf="displaySalary">Uzdarbis</td>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr *ngFor="let employee of month['employees']" class="employee-row ">
                                                <td *ngIf="employee">{{employee.firstname}} {{employee.lastname}}</td>
                                                <td *ngIf="employee">{{employee.position.job_title}}</td>
                                                <td *ngFor="let dayNumber of calendarDayNumbers">
                                                    <div *ngFor="let workDay of employee.work_days">
                                                        <div class="common-schedule-work-day-cell"
                                                             *ngIf="getDay(workDay.date) === dayNumber">
                                                            <div class="work-hours-container">
                                                                <strong>
                                                                    {{workDay.start_time}}
                                                                </strong><br>
                                                                <strong>
                                                                    {{workDay.end_time}}
                                                                </strong>
                                                            </div>
                                                            <div *ngIf="workDay.breaks">
                                                                <div *ngFor="let break of workDay.breaks"
                                                                     class="break-label">
                                                                    <i>
                                                                        {{break.start}}
                                                                    </i><br>
                                                                    <i>
                                                                        {{break.end}}
                                                                    </i>

                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td *ngIf="employee && employee.month_salary.work_hours">
                                                    {{employee.month_salary.work_hours.ordinary_hours |
                                                    timeConversion:'toTime'}}
                                                </td>
                                                <td *ngIf="employee && employee.month_salary.work_hours">
                                                    {{employee.month_salary.work_hours.night_hours |
                                                    timeConversion:'toTime'}}
                                                </td>
                                                <td *ngIf="employee && employee.month_salary.work_hours">
                                                    {{employee.month_salary.work_hours.holiday_hours |
                                                    timeConversion:'toTime'}}
                                                </td>
                                                <td *ngIf="employee && employee.month_salary.work_hours">
                                                    {{employee.month_salary.work_hours.ordinary_hours +
                                                    employee.month_salary.work_hours.night_hours +
                                                    employee.month_salary.work_hours.holiday_hours |
                                                    timeConversion:'toTime'}}
                                                </td>
                                                <td *ngIf="employee && employee.month_salary.work_hours && displaySalary">
                                                    {{employee.month_salary.work_hours.ordinary_hours *
                                                    employee.position.pay + employee.month_salary.work_hours.night_hours
                                                    *
                                                    configRef.data.night_time_rate +
                                                    employee.month_salary.work_hours.night_hours * employee.position.pay
                                                    +
                                                    employee.month_salary.work_hours.holiday_hours *
                                                    configRef.data.holiday_rate | number:"1.2-2"}}
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                        <div>
                                            <strong class="red-square medium-padding-horizontal"> Darbo
                                                valandos </strong>
                                            <i class="green-square medium-padding-horizontal"> Pertraukos </i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </kendo-pdf-export>
            </div>
        </mat-card-content>
    </mat-card>
</div>